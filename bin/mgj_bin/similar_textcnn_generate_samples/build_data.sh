#!/usr/bin/env bash
USER=qiuyu
export py2env=/home/dixin/python/py2env/bin/activate
export HOME=/home/${USER}/

today_time=$(date --date="0 day" +"%m%d")
yesterday_time=$(date --date="-1 day" +"%m%d")
last_time=$(date --date="-2 day" +"%m%d")
visit_date=$(date --date="0 day" +"%Y%m%d")
last_date=$(date --date="-1 day" +"%Y%m%d")
# Directory containing preprocessed MSCOCO data.
MSCOCO_DIR="${HOME}/similar_textcnn_generate_samples"
if [ ! -d "${MSCOCO_DIR}" ]; then
  mkdir ${MSCOCO_DIR}
fi
# Vocabulary file generated by the preprocessing script.
VOCAB_FILE="${MSCOCO_DIR}/word_counts.txt"
cd ${HOME}

source ${py2env}
CUDA_VISIBLE_DEVICES=${gpu}  python "${HOME}/im2txt/test_im2txt/data/build_mgj_data.py"  \
  --train_image_dir="${MSCOCO_DIR}/train_data" \
  --val_image_dir="${MSCOCO_DIR}/val_data" \
  --train_captions_file="${MSCOCO_DIR}/similar_textcnn_train_.json" \
  --val_captions_file="${MSCOCO_DIR}/similar_textcnn_val_.json" \
  --output_dir="${MSCOCO_DIR}/tfrecord_data" \
  --word_counts_output_file="${VOCAB_FILE}"
gpu=2
